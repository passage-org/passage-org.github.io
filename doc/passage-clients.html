<!DOCTYPE html>
<html lang="en">
<head>
<!-- 2025-05-27 Tue 09:07 -->
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Passage's Homepage</title>
<meta name="author" content="chat-wane" />
<meta name="generator" content="Org Mode" />
<style>
  #content { max-width: 60em; margin: auto; }
  .title  { text-align: center;
             margin-bottom: .2em; }
  .subtitle { text-align: center;
              font-size: medium;
              font-weight: bold;
              margin-top:0; }
  .todo   { font-family: monospace; color: red; }
  .done   { font-family: monospace; color: green; }
  .priority { font-family: monospace; color: orange; }
  .tag    { background-color: #eee; font-family: monospace;
            padding: 2px; font-size: 80%; font-weight: normal; }
  .timestamp { color: #bebebe; }
  .timestamp-kwd { color: #5f9ea0; }
  .org-right  { margin-left: auto; margin-right: 0px;  text-align: right; }
  .org-left   { margin-left: 0px;  margin-right: auto; text-align: left; }
  .org-center { margin-left: auto; margin-right: auto; text-align: center; }
  .underline { text-decoration: underline; }
  #postamble p, #preamble p { font-size: 90%; margin: .2em; }
  p.verse { margin-left: 3%; }
  pre {
    border: 1px solid #e6e6e6;
    border-radius: 3px;
    background-color: #f2f2f2;
    padding: 8pt;
    font-family: monospace;
    overflow: auto;
    margin: 1.2em;
  }
  pre.src {
    position: relative;
    overflow: auto;
  }
  pre.src:before {
    display: none;
    position: absolute;
    top: -8px;
    right: 12px;
    padding: 3px;
    color: #555;
    background-color: #f2f2f299;
  }
  pre.src:hover:before { display: inline; margin-top: 14px;}
  /* Languages per Org manual */
  pre.src-asymptote:before { content: 'Asymptote'; }
  pre.src-awk:before { content: 'Awk'; }
  pre.src-authinfo::before { content: 'Authinfo'; }
  pre.src-C:before { content: 'C'; }
  /* pre.src-C++ doesn't work in CSS */
  pre.src-clojure:before { content: 'Clojure'; }
  pre.src-css:before { content: 'CSS'; }
  pre.src-D:before { content: 'D'; }
  pre.src-ditaa:before { content: 'ditaa'; }
  pre.src-dot:before { content: 'Graphviz'; }
  pre.src-calc:before { content: 'Emacs Calc'; }
  pre.src-emacs-lisp:before { content: 'Emacs Lisp'; }
  pre.src-fortran:before { content: 'Fortran'; }
  pre.src-gnuplot:before { content: 'gnuplot'; }
  pre.src-haskell:before { content: 'Haskell'; }
  pre.src-hledger:before { content: 'hledger'; }
  pre.src-java:before { content: 'Java'; }
  pre.src-js:before { content: 'Javascript'; }
  pre.src-latex:before { content: 'LaTeX'; }
  pre.src-ledger:before { content: 'Ledger'; }
  pre.src-lisp:before { content: 'Lisp'; }
  pre.src-lilypond:before { content: 'Lilypond'; }
  pre.src-lua:before { content: 'Lua'; }
  pre.src-matlab:before { content: 'MATLAB'; }
  pre.src-mscgen:before { content: 'Mscgen'; }
  pre.src-ocaml:before { content: 'Objective Caml'; }
  pre.src-octave:before { content: 'Octave'; }
  pre.src-org:before { content: 'Org mode'; }
  pre.src-oz:before { content: 'OZ'; }
  pre.src-plantuml:before { content: 'Plantuml'; }
  pre.src-processing:before { content: 'Processing.js'; }
  pre.src-python:before { content: 'Python'; }
  pre.src-R:before { content: 'R'; }
  pre.src-ruby:before { content: 'Ruby'; }
  pre.src-sass:before { content: 'Sass'; }
  pre.src-scheme:before { content: 'Scheme'; }
  pre.src-screen:before { content: 'Gnu Screen'; }
  pre.src-sed:before { content: 'Sed'; }
  pre.src-sh:before { content: 'shell'; }
  pre.src-sql:before { content: 'SQL'; }
  pre.src-sqlite:before { content: 'SQLite'; }
  /* additional languages in org.el's org-babel-load-languages alist */
  pre.src-forth:before { content: 'Forth'; }
  pre.src-io:before { content: 'IO'; }
  pre.src-J:before { content: 'J'; }
  pre.src-makefile:before { content: 'Makefile'; }
  pre.src-maxima:before { content: 'Maxima'; }
  pre.src-perl:before { content: 'Perl'; }
  pre.src-picolisp:before { content: 'Pico Lisp'; }
  pre.src-scala:before { content: 'Scala'; }
  pre.src-shell:before { content: 'Shell Script'; }
  pre.src-ebnf2ps:before { content: 'ebfn2ps'; }
  /* additional language identifiers per "defun org-babel-execute"
       in ob-*.el */
  pre.src-cpp:before  { content: 'C++'; }
  pre.src-abc:before  { content: 'ABC'; }
  pre.src-coq:before  { content: 'Coq'; }
  pre.src-groovy:before  { content: 'Groovy'; }
  /* additional language identifiers from org-babel-shell-names in
     ob-shell.el: ob-shell is the only babel language using a lambda to put
     the execution function name together. */
  pre.src-bash:before  { content: 'bash'; }
  pre.src-csh:before  { content: 'csh'; }
  pre.src-ash:before  { content: 'ash'; }
  pre.src-dash:before  { content: 'dash'; }
  pre.src-ksh:before  { content: 'ksh'; }
  pre.src-mksh:before  { content: 'mksh'; }
  pre.src-posh:before  { content: 'posh'; }
  /* Additional Emacs modes also supported by the LaTeX listings package */
  pre.src-ada:before { content: 'Ada'; }
  pre.src-asm:before { content: 'Assembler'; }
  pre.src-caml:before { content: 'Caml'; }
  pre.src-delphi:before { content: 'Delphi'; }
  pre.src-html:before { content: 'HTML'; }
  pre.src-idl:before { content: 'IDL'; }
  pre.src-mercury:before { content: 'Mercury'; }
  pre.src-metapost:before { content: 'MetaPost'; }
  pre.src-modula-2:before { content: 'Modula-2'; }
  pre.src-pascal:before { content: 'Pascal'; }
  pre.src-ps:before { content: 'PostScript'; }
  pre.src-prolog:before { content: 'Prolog'; }
  pre.src-simula:before { content: 'Simula'; }
  pre.src-tcl:before { content: 'tcl'; }
  pre.src-tex:before { content: 'TeX'; }
  pre.src-plain-tex:before { content: 'Plain TeX'; }
  pre.src-verilog:before { content: 'Verilog'; }
  pre.src-vhdl:before { content: 'VHDL'; }
  pre.src-xml:before { content: 'XML'; }
  pre.src-nxml:before { content: 'XML'; }
  /* add a generic configuration mode; LaTeX export needs an additional
     (add-to-list 'org-latex-listings-langs '(conf " ")) in .emacs */
  pre.src-conf:before { content: 'Configuration File'; }

  table { border-collapse:collapse; }
  caption.t-above { caption-side: top; }
  caption.t-bottom { caption-side: bottom; }
  td, th { vertical-align:top;  }
  th.org-right  { text-align: center;  }
  th.org-left   { text-align: center;   }
  th.org-center { text-align: center; }
  td.org-right  { text-align: right;  }
  td.org-left   { text-align: left;   }
  td.org-center { text-align: center; }
  dt { font-weight: bold; }
  .footpara { display: inline; }
  .footdef  { margin-bottom: 1em; }
  .figure { padding: 1em; }
  .figure p { text-align: center; }
  .equation-container {
    display: table;
    text-align: center;
    width: 100%;
  }
  .equation {
    vertical-align: middle;
  }
  .equation-label {
    display: table-cell;
    text-align: right;
    vertical-align: middle;
  }
  .inlinetask {
    padding: 10px;
    border: 2px solid gray;
    margin: 10px;
    background: #ffffcc;
  }
  #org-div-home-and-up
   { text-align: right; font-size: 70%; white-space: nowrap; }
  textarea { overflow-x: auto; }
  .linenr { font-size: smaller }
  .code-highlighted { background-color: #ffff00; }
  .org-info-js_info-navigation { border-style: none; }
  #org-info-js_console-label
    { font-size: 10px; font-weight: bold; white-space: nowrap; }
  .org-info-js_search-highlight
    { background-color: #ffff00; color: #000000; font-weight: bold; }
  .org-svg { }
</style>
<link rel="stylesheet" type="text/css" href="/css/font.css" />
<link rel="stylesheet" type="text/css" href="/css/root.css" />
<link rel="stylesheet" type="text/css" href="/css/homepage.css" />
<link rel="stylesheet" type="text/css" href="/css/code.css" />
</head>
<body>
<div id="preamble" class="status">
<div class="header-bar">
  <ul class='navigation-bar'>
    <li><a class="logo" href="/"><img src="/res/passage.svg" title="passage" width="40px"/></a></li>
    <li><a class="header_button underlined" href="https://passage-org.github.io/passage-comunica/" title="try passage x comunica">Try it!</a></li>

    <li style="float:right">
      <span class="github">
        <a href="https://github.com/passage-org" title="GitHub of passage-org">
          <!-- comes from : https://github.com/logos -->
          <svg class="logo_github" viewBox="0 0 98 96" width="30" height="30" xmlns="http://www.w3.org/2000/svg"><path fill-rule="evenodd" clip-rule="evenodd" d="M48.854 0C21.839 0 0 22 0 49.217c0 21.756 13.993 40.172 33.405 46.69 2.427.49 3.316-1.059 3.316-2.362 0-1.141-.08-5.052-.08-9.127-13.59 2.934-16.42-5.867-16.42-5.867-2.184-5.704-5.42-7.17-5.42-7.17-4.448-3.015.324-3.015.324-3.015 4.934.326 7.523 5.052 7.523 5.052 4.367 7.496 11.404 5.378 14.235 4.074.404-3.178 1.699-5.378 3.074-6.6-10.839-1.141-22.243-5.378-22.243-24.283 0-5.378 1.94-9.778 5.014-13.2-.485-1.222-2.184-6.275.486-13.038 0 0 4.125-1.304 13.426 5.052a46.97 46.97 0 0 1 12.214-1.63c4.125 0 8.33.571 12.213 1.63 9.302-6.356 13.427-5.052 13.427-5.052 2.67 6.763.97 11.816.485 13.038 3.155 3.422 5.015 7.822 5.015 13.2 0 18.905-11.404 23.06-22.324 24.283 1.78 1.548 3.316 4.481 3.316 9.126 0 6.6-.08 11.897-.08 13.526 0 1.304.89 2.853 3.316 2.364 19.412-6.52 33.405-24.935 33.405-46.691C97.707 22 75.788 0 48.854 0z"/></svg>
        </a>
      </span>
    </li>
    
    <li style="float:right">
      <input id="dark-light-toggle" name="dark-light-toggle" style="display:none" type="checkbox" />
      <a href="#" onclick="document.getElementById('dark-light-toggle').checked = !document.getElementById('dark-light-toggle').checked" class="about" title="Toggle dark/light mode">
        <!-- comes from https://www.svgrepo.com/svg/362877/moon-bold licensed MIT, from phosphor-->
        <svg class="logo_about" viewBox="0 0 256 256" xmlns="http://www.w3.org/2000/svg" width="36" height="36">
          <g><path d="M228.13086,149.11719A12.00407,12.00407,0,0,0,213.168,141.165,80.03157,80.03157,0,0,1,114.85742,42.75,12.00191,12.00191,0,0,0,99.939,27.833,104.01378,104.01378,0,1,0,228.18555,155.99512,12.00185,12.00185,0,0,0,228.13086,149.11719ZM128,208A80.01075,80.01075,0,0,1,88.14551,58.61719a103.98165,103.98165,0,0,0,109.2373,109.2373A80.31015,80.31015,0,0,1,128,208Z"></path></g>
        </svg>
      </a>
    </li>
    
  </ul>
</div>
</div>
<div id="content" class="content">
<h1 class="title">Passage's Homepage</h1>
<h1>Smart Clients: Automate Partial Executions until Completion.</h1>


<p>
When a SPARQL query times out, Passage provides partial results
along with a continuation query to retrieve the missing
results. Therefore, an end-user must sends back the continuation query
to the Passage server to get the missing results (possibly
multiple times when continuation queries time out as well).
</p>

<pre class="example" id="org653e012">
  end-user                                          passage-server
     ┃                                                     ┃
     ┃ ── curl SPARQL query ─────────────────────────────&gt; ┃
     ┃                                                     ┣ 60s-timeout
     ┃ &lt;─────────── partial results, continuation query ── ┃
     ┃                                                     ┃
     ┃ ── curl continuation query ───────────────────────&gt; ┃
     ┃                                                     ┣ 60s-timeout
     ┃ &lt;─────────────────────────────── partial results ── ┃
done ┛                                                     ┃
</pre>


<p>
To ease this tedious process, we rely on smart clients to implement
the loop until completion:
</p>

<pre class="example" id="org0968445">
  end-user  smart-client                            passage-server
     ┃           ┃                                         ┃
     ┃ ───────── ┃ ── SPARQL query ──────────────────────&gt; ┃
     ┃           ┃                                         ┣ 60s-timeout
     ┃           ┃ &lt;─ partial results, continuation query  ┃
     ┃           ┃                                         ┃
     ┃           ┃ ── continuation query ────────────────&gt; ┃
     ┃           ┃                                         ┣ 60s-timeout
     ┃ &lt;──────── ┃ ──────────────────── partial results ── ┃
done ┛                                                     ┃
</pre>


<p>
We also rely on smart clients to fill the gap between SPARQL 1.1 and
the current state of supported operators by Passage. When an
operator is not (<i>yet</i>) supported by Passage, the smart client
handles the operator itself. Together, they provide complete and
correct results for SPARQL.
</p>
<div class="right-comment" id="org658dee0">
<p>
We still want to push as many operators as possible to the server. It
improves on query execution times, reduces generated traffic, etc.
</p>

</div>


<div class='table-logo-container' style='margin-bottom: -90px'>
<table class='table-logo'>
<tbody>
<tr>
<td><img class="table-logo" src="/res/comunica.svg" /></td>
</tr>
</tbody>
</table>
</div>

<div id="outline-container-orga880212" class="outline-2">
<h2 id="orga880212">Comunica</h2>
<div class="outline-text-2" id="text-orga880212">
<p>
For our first release, we took advantage of the smart client <a href="https://comunica.dev/">Comunica
<code>v4.0.x</code></a> [<a href="#citeproc_bib_item_1">1</a>].  Comunica is a SPARQL
query engine with an emphasis on modularity. To ensure completeness of
query results, it already includes actors such as quad pattern
fragments (qpf), or brqpf. We wanted to provide one for continuation
queries. Following the recommendation, we implemented <a href="https://github.com/passage-org/passage-comunica/tree/main/packages/actor-query-source-identify-hypermedia-passage">our own actor</a>
which mostly ressembles their SPARQL source actor.
</p>

<p>
In this version <code>v4.0.x</code>, you can state the range of supported
operators, and the engine will decompose the query for you: operators
handled by Passage, and operators handled by Comunica.
</p>
</div>

<div id="outline-container-org9e18a27" class="outline-3">
<h3 id="org9e18a27">Quickstart</h3>
<div class="outline-text-3" id="text-org9e18a27">
<div class="org-src-container">
<pre class="src src-shell"><span class="org-comment-delimiter"># </span><span class="org-comment">Retrieve the sources</span>
git clone git@github.com:passage-org/passage-comunica.git
<span class="org-builtin">cd</span> passage-comunica

<span class="org-comment-delimiter"># </span><span class="org-comment">Similarly to Comunica</span>
yarn install

yarn run query-passage <span class="org-sh-escaped-newline">\</span>
     http://localhost:3000/watdiv10M.jnl/passage <span class="org-sh-escaped-newline">\</span>
     -f path/to/query --logLevel=debug &gt; results.dat
</pre>
</div>

<p>
In this script, we ask the already running Passage endpoint on
<code>localhost:3000</code> to provide the results to the query
<code>path/to/query</code>. We enable <code>debug</code> to print the continuation queries
on the standard error output stream, while the results are printed in
<code>results.dat</code>.
</p>
</div>
</div>
</div>

<div id="outline-container-contributing" class="outline-2">
<h2 id="contributing">Contributing</h2>
<div class="outline-text-2" id="text-contributing">
</div>

<div id="outline-container-orgbb64ba0" class="outline-4">
<h4 id="orgbb64ba0">Keep the smart client up-to-date with Comunica.</h4>
<div class="outline-text-4" id="text-orgbb64ba0">
<p>
<i>For instance, the current implementation sets the subset of
  operations handled by Passage. Instead, the server should
  advertise it.</i>
</p>
</div>
</div>

<div id="outline-container-orgc705d20" class="outline-4">
<h4 id="orgc705d20">Implement the same logic in other smart clients.</h4>
<div class="outline-text-4" id="text-orgc705d20">
<p>
<i>While Comunica provides a convenient browser experience, it lacks
  some multithreading capabilities. Other engines such as <a href="https://github.com/LiUSemWeb/HeFQUIN">HeFQUIN</a>
  could fill this gap.</i>
</p>
</div>
</div>
</div>

<div id="outline-container-org708277e" class="outline-2">
<h2 id="org708277e">References</h2>
<div class="outline-text-2" id="text-org708277e">
<style>.csl-left-margin{float: left; padding-right: 0em;}
 .csl-right-inline{margin: 0 0 0 1em;}</style><div class="csl-bib-body">
  <div class="csl-entry"><a id="citeproc_bib_item_1"></a>
    <div class="csl-left-margin">1. </div><div class="csl-right-inline">Taelman R, Van Herwegen J, Vander Sande M, Verborgh R (2018) <a href="https://www.researchgate.net/profile/Ruben-Taelman/publication/327708819_Comunica_A_Modular_SPARQL_Query_Engine_for_the_Web_17th_International_Semantic_Web_Conference_Monterey_CA_USA_October_8-12_2018_Proceedings_Part_II/links/652d34806725c324010c58c7/Comunica-A-Modular-SPARQL-Query-Engine-for-the-Web-17th-International-Semantic-Web-Conference-Monterey-CA-USA-October-8-12-2018-Proceedings-Part-II.pdf">Comunica: A modular sparql query engine for the web</a>. In: The semantic web – iswc 2018: 17th international semantic web conference, monterey, ca, usa, october 8–12, 2018, proceedings, part ii. Springer-Verlag, Berlin, Heidelberg, pp 239–255</div>
  </div>
</div>
</div>
</div>
</div>
<div id="postamble" class="status">
<p class="text-center">
  Ⓒ 2017–2025
  <a href="https://sites.google.com/site/gddlina/">GDD Team</a>,
  <a href="https://www.ls2n.fr?lang=en">LS2N</a>,
  <a href="http://www.univ-nantes.fr/">University of Nantes</a>
</p>
</div>
</body>
</html>
